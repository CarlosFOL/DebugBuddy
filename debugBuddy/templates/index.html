<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Gradiant - Best professional</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../static/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../static/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../static/assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="../static/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="../static/css/main.css" rel="stylesheet">

  <!-- =======================================================
  * Template Name: eStartup
  * Template URL: https://bootstrapmade.com/estartup-bootstrap-landing-page-template/
  * Updated: Aug 07 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body class="index-page">

  <header id="header" class="header d-flex align-items-center sticky-top">
    <div class="container-fluid container-xl position-relative d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center">
        <!-- Uncomment the line below if you also wish to use an image logo -->
        <img src="../static/img/logo.jpeg" alt="">
        <h1 style="font-weight: 700;">Busca a tu profesional cualificado</h1>
      </a>

    </div>
  </header>

<!--Seleccionar categoria y subcategoria-->
  <section id="hero" class="hero section light-background">
    <label for="categorycb">Categoria</label>
      <select id="categorycb" name="categorycb">
        <option value="" selected></option>
      {%for cat in categories%}  
        <option value="{{cat[0]}}">{{cat[1]}}</option>
      {%endfor%}
      </select>


      <label for="subcatcb">Especialidad</label>
      <select id="subcatcb" name="subcatcb">
        <option value = '' selected></option>
      </select>


      <div id = "skills_container" style="margin-left: 300px;">
      </div>
      
    
   </section>

   <script>
    // Capturamos el evento de cambio en el primer combobox
    document.getElementById('categorycb').addEventListener('change', function() {
        const categoryId = this.value;  // Obtener el ID de la categoría seleccionada
        
        if (categoryId) {
            // Hacer la solicitud al backend para obtener las subcategorías
            fetch(`/get_subcategories/${categoryId}`)
                .then(response => response.json())
                .then(subcategories => {
                    // Limpiar las opciones del segundo combobox
                    const subcatComboBox = document.getElementById('subcatcb');
                    subcatComboBox.innerHTML = ''
                    // subcatComboBox.innerHTML = '<option value="" selected>Seleccione una especialidad</option>';

                    // Agregar las nuevas opciones de subcategorías
                    subcategories.forEach(subcat => {
                        const optionElement = document.createElement('option');
                        optionElement.value = subcat[0];  // ID de la subcategoría
                        optionElement.textContent = subcat[1];  // Nombre de la subcategoría
                        subcatComboBox.appendChild(optionElement);
                    });
                })
                
                
        } else {
            // Limpiar el segundo combobox si no se seleccionó categoría
            document.getElementById('subcatcb').innerHTML = '';
        }
    });

    document.getElementById("subcatcb").addEventListener('change', function() {
      const subcatId = this.value // Id de la subcategoria
      if (subcatId){
        const container = document.getElementById("skills_container");
        const url = `/get_issues`
        fetch(url).
        then(response => response.json()).
        then(skills => {
          const n_buttons = skills.length
          skills.forEach(skill => {
          const button = document.createElement("button");
          button.textContent = skill;  
          button.setAttribute("id", `btn btn-primary`); 
          button.setAttribute("style", `width: 300px;height: 100px; margin-top:100px; margin-left: 100px;`); 
          container.appendChild(button);
          // button.addEventListener("click", () => {
            // console.log(`Botón ${item.id} presionado: ${item.nombre}`);
        });
      });
}});
</script>

  <!-- Main JS File -->
  <script src="../static/js/main.js"></script>

</body>
</html>